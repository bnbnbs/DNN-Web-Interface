<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNNWebService - Feedback AAC</title>
    <link rel="stylesheet" href="index.css"> 
    <link rel="stylesheet" href="feedback_aac.css">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.css" />
</head>
<body>
    <header class="navbar">
        <div class="nav-container">
            <div class="logo"><a href="index.html">DNNWebService</a></div>
            <nav>
                <ul class="nav-links">
                    <li>
                        <a href="convert_T2A.html" class="dropdown-trigger"> Convert 
                            <svg class="dropdown-icon" width="17" height="12" viewBox="0 0 17 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M1 1L8.5 10L16 1" stroke="white" stroke-width="2"/>
                            </svg>
                        </a>
                        <ul class="dropdown-content">
                            <li><a href="convert_T2A.html">Text2AAC</a></li>
                            <li><a href="convert_A2T.html">AAC2Text</a></li>
                        </ul>
                    </li>
                    <li><a href="feedback.html" style="opacity: 1; font-weight: semibold;">Feedback</a></li>
                    <li><a href="conversation_main.html">Conversation</a></li>
                    <li><a href="aboutUs.html">About Us</a></li>
                </ul>
            </nav>
            <div class="auth-buttons"><button class="user-info-btn">pro 님</button></div>
        </div>
    </header>

    <main class="convert-container">
        <div class="convert-tabs">
            <a href="feedback.html" class="tab">Text → AAC</a>
            <a href="feedback_aac.html" class="tab active">AAC → Text</a>
        </div>

        <section class="input-section">
            <h2 class="section-title">상징 시퀀스 입력</h2>
            <div class="display-box aac-input-display" id="aacInputDisplay">
                </div>
        </section>

        <section class="search-section">
            <h2 class="section-title">검색영역</h2>
            <div class="search-bar-container">
                <input type="text" id="searchInput" placeholder="빈칸으로 구분된 단어 입력">
                <button class="search-btn-icon" onclick="showSymbols()">
                    <svg width="20" height="20" fill="white"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                </button>
            </div>
            <div class="symbol-grid" id="symbolGrid" style="display: none;">
                <div class="symbol-card" onclick="toggleSymbol('hungry', '배고파요')"><img src="img/hungry.png"><p>배고파요</p></div>
                <div class="symbol-card" onclick="toggleSymbol('thirsty', '목말라요')"><img src="img/thirsty.png"><p>목말라요</p></div>
                <div class="symbol-card" onclick="toggleSymbol('joy', '즐거워요')"><img src="img/joy.png"><p>즐거워요</p></div>
            </div>
            <div class="btn-center">
                <button class="convert-action-btn" onclick="handleConvert()">변환</button>
            </div>
        </section>

        <div class="arrow-deco">
            <svg width="60" height="30" viewBox="0 0 100 40"><path d="M10 0 L50 30 L90 0" stroke="rgba(255,255,255,0.5)" stroke-width="4" fill="none" /></svg>
        </div>

        <section class="result-section" id="resultSection" style="display: none;">
            <div class="result-group">
                <h2 class="section-title">입력한 상징 시퀀스</h2>
                <div class="display-box" id="finalAacSequence"></div>
            </div>

            <div class="result-group">
                <h2 class="section-title">변환 결과 문장</h2>
                <div class="display-box text-result" id="resultSentence"></div>
            </div>

            <div class="feedback-choice-btns">
                <button class="choice-btn correct" id="correctBtn" onclick="selectCorrect()">정답</button>
                <button class="choice-btn wrong" onclick="openPopup()">오답</button>
            </div>

            <div class="btn-center" style="margin-top: 50px;">
                <button class="complete-btn main-complete" onclick="handleFinalComplete()">Complete!</button>
            </div>
        </section>
    </main>

    <div id="correctionPopup" class="popup-overlay">
        <div class="popup-content">
            <button class="close-btn" onclick="closePopup()">✕</button>
            <h2 class="section-title">수정 답변 입력</h2>
            
            <div class="popup-group">
                <p class="popup-label">변환된 문장</p>
                <div class="popup-static-box" id="popupOriginalText"></div>
            </div>

            <div class="popup-group">
                <p class="popup-label">수정된 문장</p>
                <textarea class="popup-textarea" id="correctedText" placeholder="올바른 문장을 입력하세요"></textarea>
            </div>

            <div class="btn-center">
                <button class="complete-btn" onclick="handlePopupComplete()">Complete!</button>
            </div>
        </div>
    </div>

    <footer class="conv-footer">
        <div class="footer-top">
            <span class="footer-logo">DNNWebService</span>
            <div class="footer-links">
                <a href="#">개인정보처리방침</a>
                <a href="#">고객정보취급방침</a>
                <a href="#">신용정보활용체제</a>
            </div>
        </div>
        <hr class="footer-line">
        <div class="footer-bottom">
            <p>서울특별시 성북구 보문로 34다길 2, 성신여자대학교 수정관 212호 | 대표전화: 02-920-7114<br>Copyright @ HongLab. All rights reserved.</p>
            <div class="footer-sns">
                <span class="sns-icon"> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 00-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-1.49.95-4.22 2.79-.4.27-.76.41-1.08.4-.36-.01-1.04-.2-1.55-.37-.63-.2-1.12-.31-1.08-.66.02-.18.27-.36.74-.55 2.91-1.27 4.85-2.11 5.82-2.52 2.77-1.16 3.35-1.36 3.72-1.37.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .38z"/></svg>
                </span>
                <span class="sns-icon"> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                </span>
                <span class="sns-icon"> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.332 3.608 1.308.975.975 1.245 2.242 1.308 3.608.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.062 1.366-.332 2.633-1.308 3.608-.975.975-2.242 1.245-3.608 1.308-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.366-.062-2.633-.332-3.608-1.308-.975-.975-1.245-2.242-1.308-3.608-.058-1.266-.07-1.646-.07-4.85s.012-3.584.07-4.85c.062-1.366.332-2.633 1.308-3.608.975-.975 2.242-1.245 3.608-1.308 1.266-.058 1.646-.07 4.85-.07zm0-2.163c-3.259 0-3.667.014-4.947.072-1.277.057-2.149.259-2.912.556-.789.307-1.459.717-2.127 1.385-.668.667-1.078 1.338-1.385 2.127-.297.763-.499 1.635-.556 2.912-.058 1.28-.072 1.688-.072 4.947s.014 3.667.072 4.947c.057 1.277.259 2.149.556 2.912.307.789.717 1.459 1.385 2.127.667.668 1.338 1.078 2.127 1.385.763.297 1.635.499 2.912.556 1.28.058 1.688.072 4.947.072s3.667-.014 4.947-.072c1.277-.057 2.149-.259 2.912-.556.789-.307 1.459-.717 2.127-1.385.668-.667 1.078-1.338 1.385-2.127.297-.763.499-1.635.556-2.912.058-1.28.072-1.688.072-4.947s-.014-3.667-.072-4.947c-.057-1.277-.259-2.149-.556-2.912-.307-.789-.717-1.459-1.385-2.127-.668-.667-1.338-1.078-2.127-1.385-.763-.297-1.635-.499-2.912-.556-1.28-.058-1.688-.072-4.947-.072z"/></svg>
                </span>
            </div>
        </div>
    </footer>

    <script>
        let selectedSymbols = new Map();

        // 돋보기 클릭 시 상징 목록 표시
        function showSymbols() {
            document.getElementById('symbolGrid').style.display = 'grid';
        }

        // 상징 클릭 시 토글 (홀수번 입력/짝수번 삭제)
        function toggleSymbol(id, name) {
            if (selectedSymbols.has(id)) {
                selectedSymbols.delete(id);
            } else {
                selectedSymbols.set(id, name);
            }
            updateInputDisplay();
        }

        function updateInputDisplay() {
            const display = document.getElementById('aacInputDisplay');
            let html = "";
            selectedSymbols.forEach((name, id) => {
                html += `<div class="selected-item"><img src="img/${id}.png"><p>${name}</p></div>`;
            });
            display.innerHTML = html;
        }

        // 변환 버튼 클릭
        function handleConvert() {
            if (selectedSymbols.size === 0) {
                alert("상징을 먼저 선택해주세요.");
                return;
            }
            document.getElementById('resultSection').style.display = 'block';
            document.getElementById('finalAacSequence').innerHTML = document.getElementById('aacInputDisplay').innerHTML;
            document.getElementById('resultSentence').innerText = "배고파요";
            
            // 결과창으로 스크롤
            window.scrollTo({ top: document.getElementById('resultSection').offsetTop - 100, behavior: 'smooth' });

            // [추가] 결과창이 뜬 후 화면을 아래로 살짝 스크롤해서 푸터 쪽을 인지시킴
            setTimeout(() => {
            window.scrollTo({
            top: document.body.scrollHeight, // 페이지 끝까지 스크롤 가능하게 함
            behavior: 'smooth'});
            }, 100);
        }

        function selectCorrect() {
            const btn = document.getElementById('correctBtn');
            btn.classList.toggle('active'); // CSS에서 초록색 불 처리
        }

        function openPopup() {
            document.getElementById('popupOriginalText').innerText = document.getElementById('resultSentence').innerText;
            document.getElementById('correctionPopup').style.display = 'flex';
        }

        function closePopup() { document.getElementById('correctionPopup').style.display = 'none'; }

        function handlePopupComplete() {
            alert("수정완료!");
            closePopup();
        }

        function handleFinalComplete() {
            alert("저장완료!");
        }
    </script>
</body>
</html>